<!DOCTYPE html>
<html>
<head>
  <title>Authenticating...</title>
  <!-- CORRECTED: Using the latest, stable, and correct CDN URL for the Teams SDK -->
  <script src="https://res.cdn.office.net/teams-js/2.21.0/js/MicrosoftTeams.min.js" xintegrity="sha384-53k2f2Gz7Wg3h3c2dG2h3gqO2S1c5s1xT+3F+efT6e/R3MHIeTCa1k24l/g31fI1" crossorigin="anonymous"></script>
</head>
<body>
  <p>Please wait while we complete your sign-in...</p>
  <script>
    // This script runs inside the Teams-managed popup.
    microsoftTeams.app.initialize().then(() => {
      // Check if the URL has an authentication hash (#...) from Azure AD
      if (window.location.hash) {
        // If it does, pass the entire hash back to the main app window.
        // The main app is waiting for this success signal.
        microsoftTeams.authentication.notifySuccess(window.location.hash);
      } else {
        // If there's no hash, something went wrong.
        microsoftTeams.authentication.notifyFailure("No authentication hash found in the redirect URL.");
      }
    });
  </script>
</body>
</html>

